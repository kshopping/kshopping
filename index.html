<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>K-Shopping</title>
<link rel="stylesheet" href="css/index.css">

<style>
/* ===== í—¤ë” ë ˆì´ì•„ì›ƒ ===== */
#fixed-header-inner {
  display: flex;
  align-items: center;
}

/* ============================= âœ…âœ…âœ… 1ì•ˆ ë²ˆê°œí˜• ë¡œê³  ì—…ê·¸ë ˆì´ë“œ (í”„ë¡œê¸‰) ============================= */
.brand-area {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 8px;
}

.brand-row {
  display: flex;
  align-items: center;
  gap: 12px;
}

/* ë¡œê³  ë²„íŠ¼ */
.logo-btn {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  user-select: none;
  white-space: nowrap;
}

/* âš¡ ë¡œê³  ì•„ì´ì½˜ */
.logo-icon {
  width: 34px;
  height: 34px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 12px;
  background: linear-gradient(180deg, #ffe083 0%, #ffc933 100%);
  box-shadow: 0 10px 24px rgba(255, 200, 0, 0.18);
  position: relative;
  overflow: hidden;
}

.logo-icon::after {
  content: "";
  position: absolute;
  inset: -40%;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.65), rgba(255,255,255,0) 60%);
  transform: rotate(20deg);
}

.logo-icon svg {
  width: 20px;
  height: 26px;
  fill: #ff4d4f;
  z-index: 2;
  position: relative;
  animation: logoZap 1.15s ease-in-out infinite;
  transform-origin: center;
}

@keyframes logoZap {
  0%   { transform: rotate(0deg) scale(1); opacity: 0.85; }
  30%  { transform: rotate(-8deg) scale(1.12); opacity: 1; }
  60%  { transform: rotate(8deg) scale(1.12); opacity: 1; }
  100% { transform: rotate(0deg) scale(1); opacity: 0.85; }
}

/* K-Shopping íƒ€ì´í¬ */
.logo-text {
  font-size: 30px;
  font-weight: 950;
  letter-spacing: -0.6px;
  color: #ff4d4f;
  line-height: 1;
}

.logo-sub {
  margin-left: 2px;
  font-size: 12px;
  font-weight: 800;
  color: rgba(0,0,0,0.55);
  letter-spacing: 0.2px;
}

/* ìŠ¬ë¡œê±´ ë°°ì§€ */
.slogan-badge {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 999px;
  background: linear-gradient(180deg, #fff7d1 0%, #ffe083 100%);
  border: 1px solid rgba(255, 200, 0, 0.45);
  font-size: 14px;
  font-weight: 900;
  color: #ff7a00;
  box-shadow: 0 10px 26px rgba(255, 200, 0, 0.14);
  white-space: nowrap;
}

.slogan-badge .zap {
  color: #ff4d4f;
  font-weight: 900;
}

.slogan-badge .mini-zap {
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.slogan-badge .mini-zap svg {
  width: 14px;
  height: 18px;
  fill: #ff4d4f;
}

/* ì „í™”/ë¬¸ì˜ (CTA ëŠë‚Œ) */
.header-call {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 0;
  font-size: 13px;
  font-weight: 800;
  color: rgba(0,0,0,0.6);
  white-space: nowrap;
}

.header-call .call-label {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  color: rgba(0,0,0,0.58);
  font-weight: 800;
}

.call-link {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 8px 12px;
  border-radius: 999px;
  text-decoration: none;
  font-weight: 900;
  color: #ff4d4f;
  background: rgba(255, 77, 79, 0.08);
  border: 1px solid rgba(255, 77, 79, 0.18);
  box-shadow: 0 8px 18px rgba(255, 77, 79, 0.10);
  transition: 0.22s ease;
  pointer-events: auto;
  z-index: 10;
}

.call-link:hover {
  transform: translateY(-1px);
  background: rgba(255, 77, 79, 0.12);
}

/* âœ… ëª¨ë°”ì¼ì—ì„œ ë°°ì§€/ì „í™” ì¤„ ì •ë¦¬ */
@media (max-width: 768px){
  .brand-row { gap: 10px; }
  .logo-text { font-size: 26px; }
  .slogan-badge {
    font-size: 13px;
    padding: 7px 10px;
  }
}
</style>
</head>

<body>
<header id="fixed-header">
  <div id="fixed-header-inner">

    <!-- âœ… LEFT: í”„ë¡œê¸‰ ë¡œê³  + ë°°ì§€ + ìƒë‹´ CTA -->
    <div class="header-left brand-area">

      <div class="brand-row">
        <div class="logo-btn" onclick="location.href='index.html'">
          <span class="logo-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24">
              <path d="M13 2L3 14h7l-1 8 10-12h-7l1-8z"/>
            </svg>
          </span>

          <div class="logo-typo">
            <div class="logo-text">K-Shopping</div>
            <div class="logo-sub">Korea Lightning Deal Market</div>
          </div>
        </div>

        <div class="slogan-badge" title="ëŒ€í•œë¯¼êµ­ ë²ˆê°œ ì´ˆíŠ¹ê°€ ì‡¼í•‘ëª°">
          <span class="zap">ëŒ€í•œë¯¼êµ­ ë²ˆê°œ</span>
          <span class="mini-zap" aria-hidden="true">
            <svg viewBox="0 0 24 24">
              <path d="M13 2L3 14h7l-1 8 10-12h-7l1-8z"/>
            </svg>
          </span>
          <span>ì´ˆíŠ¹ê°€ ì‡¼í•‘ëª°</span>
        </div>
      </div>

      <div class="header-call">
        <span class="call-label">ğŸ“ Call / ë¬¸ì˜</span>
        <a class="call-link" href="tel:+821086408732">010-8640-8732</a>
        <a class="call-link" href="tel:+82522560994">052-256-0994</a>
      </div>

    </div>

    <!-- âœ… RIGHT: ì¥ë°”êµ¬ë‹ˆë§Œ ìœ ì§€ / ê´€ë¦¬ì ë²„íŠ¼ ì™„ì „ ìˆ¨ê¹€ -->
    <div id="top-menu">
      <button id="cartGoBtn" class="cart-main-btn">ğŸ›’ <span id="cartCount"></span></button>
      <div id="cart-preview"></div>
    </div>

  </div>

  <nav id="category-area"></nav>
</header>

<main id="wrap">
  <section id="banner-area">
    <div id="banner-text-overlay">
      ğŸ’¸ ì§€ê¸ˆ ì´ ê°€ê²©, ë†“ì¹˜ë©´ ì†í•´! ì „ ìƒí’ˆ ì´ˆíŠ¹ê°€ í• ì¸ ì¤‘! ğŸ”¥
    </div>
  </section>

  <section id="today-deal"></section>

  <section class="bank-info-box">
    <div class="bank-icon">ğŸ›’</div>
    <div class="bank-text">
      <div class="bank-label">êµ¬ë§¤ Â· ê²°ì œ ì•ˆë‚´</div>
      <div class="bank-value">
        <span class="highlight-red">NO CARD REQUIRED</span> Â· ì¹´ë“œ ì—†ì´ êµ¬ë§¤ ê°€ëŠ¥<br>
        <span class="highlight-red">Cash Transfer OK</span> Â· ì…ê¸ˆ í™•ì¸ í›„ ì¦‰ì‹œ ë°°ì†¡
        <span class="shipping-fast highlight-red"><span>ğŸšš</span> FAST SHIPPING</span>
      </div>
    </div>
  </section>

  <section id="product-section">
    <div id="product-area" class="product-grid"></div>
  </section>
</main>

<div id="toast"></div>

<!-- âœ… DEALER POPUP START -->
<style>
#dealer-popup {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.65);
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dealer-popup-wrap {
  position: relative;
  width: 90vw;
  max-width: 420px;
  pointer-events: auto;
}

.dealer-popup-img {
  width: 100%;
  display: block;
  border-radius: 16px;
}

/* âœ… ì¿ í° ì˜¤ë²„ë ˆì´ */
.dealer-coupon-overlay {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  z-index: 30;
  width: 88%;
  padding: 12px 14px;
  border-radius: 14px;
  text-align: center;
  font-weight: 900;
  cursor: pointer;
  user-select: none;
  display: none;
}

.dealer-coupon-overlay .coupon-title {
  font-size: 13px;
  font-weight: 800;
  opacity: 0.95;
  margin-bottom: 6px;
}

.dealer-coupon-overlay .coupon-code {
  font-size: 20px;
  letter-spacing: 1px;
}

.dealer-coupon-overlay .coupon-sub {
  margin-top: 6px;
  font-size: 12px;
  font-weight: 700;
  opacity: 0.9;
}

/* ìƒë‹¨ X */
.dealer-close-x {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 34px;
  height: 34px;
  border-radius: 50%;
  border: none;
  background: #fff;
  font-size: 18px;
  font-weight: 900;
  cursor: pointer;
  z-index: 40;
}

/* í•˜ë‹¨ Close ë²„íŠ¼ */
.dealer-close-bottom {
  position: absolute;
  bottom: 6%;
  left: 50%;
  transform: translateX(-50%);
  width: 50%;
  height: 9%;
  cursor: pointer;
  z-index: 15;
}

/* ì–¸ì–´ ì„ íƒ ì˜ì—­ */
.dealer-lang-btn {
  position: absolute;
  top: 40%;
  bottom: 20%;
  z-index: 10;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.dealer-lang-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 12px 25px rgba(0,0,0,0.25);
}
.lang-en { left: 0%;  width: 25%; }
.lang-vi { left: 25%; width: 25%; }
.lang-th { left: 50%; width: 25%; }
.lang-id { left: 75%; width: 25%; }

/* âœ… ë³µì‚¬ í† ìŠ¤íŠ¸ */
#couponToast {
  position: fixed;
  left: 50%;
  bottom: 18px;
  transform: translateX(-50%);
  z-index: 20000;
  background: rgba(0,0,0,0.85);
  color: #fff;
  padding: 10px 14px;
  border-radius: 999px;
  font-size: 13px;
  font-weight: 800;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.25s ease;
}
#couponToast.show { opacity: 1; }
</style>

<div id="dealer-popup" style="display:none;">
  <div class="dealer-popup-wrap" id="dealerWrap">
    <button class="dealer-close-x" onclick="dealerClosePopup()">Ã—</button>

    <div id="dealerCoupon" class="dealer-coupon-overlay" onclick="dealerCopyCoupon()">
      <div class="coupon-title" id="couponTitle">ğŸ ì¿ í°</div>
      <div class="coupon-code" id="couponCode">WELCOME10</div>
      <div class="coupon-sub" id="couponSub">Tap to copy</div>
    </div>

    <img id="dealerPopupImg" class="dealer-popup-img"
      src="images/dealer_popup_select.png" alt="Dealer Popup">

    <div class="dealer-lang-btn lang-en" onclick="dealerChangeLang('en')"></div>
    <div class="dealer-lang-btn lang-vi" onclick="dealerChangeLang('vi')"></div>
    <div class="dealer-lang-btn lang-th" onclick="dealerChangeLang('th')"></div>
    <div class="dealer-lang-btn lang-id" onclick="dealerChangeLang('id')"></div>

    <div class="dealer-close-bottom" onclick="dealerClosePopup()"></div>
  </div>
</div>

<div id="couponToast">âœ… Copied!</div>

<script>
const POPUP_CONFIG_KEY = "dealer_popup_config";
const POPUP_SEEN_KEY = "dealer_popup_seen";

const defaultDealerPopupConfig = {
  enabled: false,
  startDate: "2025-01-01",
  endDate: "2026-12-31",
  showOncePerDay: true,
  storageKey: POPUP_SEEN_KEY,
  defaultImage: "images/dealer_popup_select.png",
  langImages: {
    en: "images/dealer_popup_en.png",
    vi: "images/dealer_popup_vi.png",
    th: "images/dealer_popup_th.png",
    id: "images/dealer_popup_id.png"
  },
  clickLink: "",
  coupon: {
    enabled: false,
    title: "ğŸ Coupon",
    code: "WELCOME10",
    sub: "Tap to copy",
    position: "bottom",
    fontSize: 20,
    bg: true,
    textColor: "#ffffff",
    bgColor: "rgba(0,0,0,0.78)"
  }
};

function loadDealerPopupConfig() {
  try {
    const raw = localStorage.getItem(POPUP_CONFIG_KEY);
    if (!raw) return { ...defaultDealerPopupConfig };
    const parsed = JSON.parse(raw);

    return {
      ...defaultDealerPopupConfig,
      ...parsed,
      langImages: { ...defaultDealerPopupConfig.langImages, ...(parsed.langImages || {}) },
      coupon: { ...defaultDealerPopupConfig.coupon, ...(parsed.coupon || {}) },
      storageKey: POPUP_SEEN_KEY
    };
  } catch (e) {
    return { ...defaultDealerPopupConfig };
  }
}

let dealerPopupConfig = loadDealerPopupConfig();
let dealerPopupClosed = false;

function dealerIsWithinPeriod() {
  const now = new Date();
  const start = new Date(dealerPopupConfig.startDate + "T00:00:00");
  const end = new Date(dealerPopupConfig.endDate + "T23:59:59");
  return now >= start && now <= end;
}

function dealerGetTodayKey() {
  const d = new Date();
  const yyyy = d.getFullYear();
  const mm = String(d.getMonth() + 1).padStart(2, "0");
  const dd = String(d.getDate()).padStart(2, "0");
  return `${yyyy}-${mm}-${dd}`;
}

function dealerShouldShowPopup() {
  if (!dealerPopupConfig.enabled) return false;
  if (!dealerIsWithinPeriod()) return false;

  if (dealerPopupConfig.showOncePerDay) {
    const seen = localStorage.getItem(dealerPopupConfig.storageKey);
    const today = dealerGetTodayKey();
    if (seen === today) return false;
  }
  return true;
}

function dealerMarkSeen() {
  if (dealerPopupConfig.showOncePerDay) {
    localStorage.setItem(dealerPopupConfig.storageKey, dealerGetTodayKey());
  }
}

function dealerOpenPopup() {
  const popup = document.getElementById("dealer-popup");
  if (!popup) return;
  popup.style.display = "flex";
  dealerMarkSeen();
}

function dealerClosePopup() {
  dealerPopupClosed = true;
  const popup = document.getElementById("dealer-popup");
  if (popup) popup.style.display = "none";
}

function dealerChangeLang(lang) {
  if (dealerPopupClosed) return;
  const img = document.getElementById("dealerPopupImg");
  if (!img) return;

  const nextImg = dealerPopupConfig.langImages[lang];
  img.src = nextImg ? nextImg : dealerPopupConfig.defaultImage;

  document.querySelectorAll(".dealer-lang-btn").forEach(el => el.remove());
  const closeBottom = document.querySelector(".dealer-close-bottom");
  if (closeBottom) closeBottom.remove();
}

function dealerBindClickLink() {
  if (!dealerPopupConfig.clickLink) return;

  const wrap = document.getElementById("dealerWrap");
  if (!wrap) return;

  wrap.style.cursor = "pointer";
  wrap.addEventListener("click", (e) => {
    const target = e.target;

    if (target && target.classList && target.classList.contains("dealer-close-x")) return;
    if (target && target.classList && target.classList.contains("dealer-lang-btn")) return;
    if (target && (target.id === "dealerCoupon" || target.closest("#dealerCoupon"))) return;

    window.open(dealerPopupConfig.clickLink, "_blank");
  });
}

function dealerApplyCouponOverlay() {
  const c = dealerPopupConfig.coupon || {};
  const box = document.getElementById("dealerCoupon");
  if (!box) return;

  if (!c.enabled) {
    box.style.display = "none";
    return;
  }

  box.style.display = "block";

  const titleEl = document.getElementById("couponTitle");
  const codeEl = document.getElementById("couponCode");
  const subEl = document.getElementById("couponSub");

  if (titleEl) titleEl.textContent = c.title || "ğŸ Coupon";
  if (codeEl) {
    codeEl.textContent = c.code || "WELCOME10";
    codeEl.style.fontSize = (Number(c.fontSize) || 20) + "px";
  }
  if (subEl) subEl.textContent = c.sub || "Tap to copy";

  box.style.color = c.textColor || "#fff";
  box.style.background = c.bg ? (c.bgColor || "rgba(0,0,0,0.78)") : "transparent";

  box.style.top = "";
  box.style.bottom = "";
  box.style.transform = "translateX(-50%)";

  const pos = (c.position || "bottom").toLowerCase();
  if (pos === "top") box.style.top = "12px";
  else if (pos === "middle") {
    box.style.top = "50%";
    box.style.transform = "translate(-50%, -50%)";
  } else box.style.bottom = "14px";
}

async function dealerCopyCoupon() {
  const c = dealerPopupConfig.coupon || {};
  const code = (c.code || "").trim();
  if (!code) return;

  try {
    await navigator.clipboard.writeText(code);
    showCouponToast("âœ… Copied: " + code);
  } catch (e) {
    const t = document.createElement("textarea");
    t.value = code;
    document.body.appendChild(t);
    t.select();
    document.execCommand("copy");
    document.body.removeChild(t);
    showCouponToast("âœ… Copied: " + code);
  }
}

let couponToastTimer = null;
function showCouponToast(text) {
  const toast = document.getElementById("couponToast");
  if (!toast) return;
  toast.textContent = text || "âœ… Copied!";
  toast.classList.add("show");

  clearTimeout(couponToastTimer);
  couponToastTimer = setTimeout(() => {
    toast.classList.remove("show");
  }, 1400);
}

/* ============================= âœ…âœ…âœ… í—¤ë” ë†’ì´ ìë™ ê³„ì‚° (ë°°ë„ˆ ê°€ë¦¼ ì™„ì „ ì œê±°) ============================= */
function applyHeaderOffset() {
  const header = document.getElementById("fixed-header");
  const wrap = document.getElementById("wrap");
  if (!header || !wrap) return;

  const headerH = header.offsetHeight || 0;
  wrap.style.paddingTop = (headerH + 38) + "px";  // âœ… [ìˆ˜ì •] ì—¬ìœ  18px â†’ 38px (ë°°ë„ˆ ì ˆëŒ€ ì•ˆ ê°€ë¦¼)
}

window.addEventListener("load", () => {
  applyHeaderOffset();
  setTimeout(applyHeaderOffset, 120);
  setTimeout(applyHeaderOffset, 300);
});

window.addEventListener("resize", () => {
  applyHeaderOffset();
});

document.addEventListener("DOMContentLoaded", () => {
  dealerPopupConfig = loadDealerPopupConfig();

  const img = document.getElementById("dealerPopupImg");
  if (img) img.src = dealerPopupConfig.defaultImage;

  dealerBindClickLink();
  dealerApplyCouponOverlay();

  if (dealerShouldShowPopup()) dealerOpenPopup();

  applyHeaderOffset();
  setTimeout(applyHeaderOffset, 120);
});
</script>
<!-- âœ… DEALER POPUP END -->

<script type="module" src="./js/index.js"></script>
</body>
</html>

